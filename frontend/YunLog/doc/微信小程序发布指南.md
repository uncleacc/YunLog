# 微信小程序发布指南

## 📋 准备工作

### 1. 已完成的配置
- ✅ AppID 已配置：`wx710ef06e5d729748`
- ✅ manifest.json 已更新
- ✅ 权限配置已添加

### 2. 需要准备的材料
- 微信开发者工具（必须）
- 小程序管理员微信账号
- 小程序图标和截图（用于发布）

## 🛠️ 构建步骤

### 第一步：安装微信开发者工具

1. 下载地址：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
2. 根据你的系统下载对应版本
3. 安装并打开

### 第二步：构建小程序代码

在项目根目录运行：

```bash
# 构建微信小程序
npm run dev:mp-weixin

# 或者构建生产版本
npm run build:mp-weixin
```

### 第三步：查看构建产物

构建完成后，代码会在以下目录：

```
开发版本：
dist/dev/mp-weixin/

生产版本：
dist/build/mp-weixin/
```

### 第四步：导入到微信开发者工具

1. 打开微信开发者工具
2. 点击"+"创建小程序项目
3. 填写项目信息：
   - 项目名称：云日记
   - 目录：选择 `dist/dev/mp-weixin` 或 `dist/build/mp-weixin`
   - AppID：选择你的小程序AppID（wx710ef06e5d729748）
   - 开发模式：小程序
   - 后端服务：不使用云服务
4. 点击"确定"

### 第五步：预览和调试

1. 开发者工具中会自动加载项目
2. 点击"预览"可以在手机上查看
3. 扫描二维码，在微信中打开测试

## 📱 测试流程

### 1. 真机预览

```
微信开发者工具 → 点击"预览" → 扫描二维码 → 手机微信打开
```

### 2. 测试功能清单

- [ ] 首页分类列表显示
- [ ] 点击分类进入详情
- [ ] 创建新日记
- [ ] 富文本编辑
- [ ] 表情选择
- [ ] 图片上传（拍照/相册）
- [ ] 视频上传
- [ ] 日记详情查看
- [ ] 编辑日记
- [ ] 删除日记（移到回收站）
- [ ] 回收站查看和恢复
- [ ] 分类管理
- [ ] 数据持久化

### 3. 注意事项

⚠️ **小程序限制**：
- 单个小程序包大小：主包不超过 2MB
- 总包大小：不超过 20MB
- 本地存储：最多 10MB
- 图片/视频：建议压缩后上传

## 🚀 发布流程

### 第一步：上传代码

1. 在微信开发者工具中，点击右上角"上传"
2. 填写版本号和备注：
   ```
   版本号：1.0.0
   项目备注：初始版本，支持日记增删改查、分类管理、富文本编辑
   ```
3. 点击"上传"

### 第二步：提交审核

1. 登录小程序管理后台：https://mp.weixin.qq.com
2. 左侧菜单：版本管理 → 开发版本
3. 找到刚上传的版本，点击"提交审核"
4. 填写审核信息

### 第三步：填写审核信息

#### 1. 功能页面
```
首页：pages/index/index
- 功能：日记分类管理
- 标签：工具

分类详情：pages/category/category  
- 功能：日记列表展示
- 标签：工具

编辑页：pages/edit/edit
- 功能：日记编辑
- 标签：工具
```

#### 2. 功能描述
```
云日记是一款简洁美观的日记应用，支持：
1. 分类管理：创建不同主题的日记分类
2. 富文本编辑：支持粗体、斜体、下划线等格式
3. 多媒体附件：支持图片和视频
4. 回收站：防止误删，支持恢复
5. 本地存储：数据安全存储在本地
```

#### 3. 测试账号（如需要）
```
无需测试账号，所有功能均可直接使用
```

#### 4. 隐私设置
需要配置以下权限说明：

```
相册权限：用于选择图片添加到日记
相机权限：用于拍照添加到日记
```

### 第四步：等待审核

- 审核时间：1-7个工作日
- 可在管理后台查看审核进度
- 审核通过后，点击"发布"即可上线

## 📝 小程序信息配置

### 基本信息（在管理后台设置）

1. **小程序名称**：云日记
2. **小程序简介**：记录生活，留住美好时光
3. **服务类别**：工具 - 备忘录/记事本

### 头像和介绍图

需要准备：
- 小程序头像：256x256px，PNG格式
- 小程序截图：5张，尺寸建议 750x1334px

### 搜索关键词
```
日记、记事本、笔记、备忘录、富文本编辑
```

## ⚙️ 开发环境切换

### 开发版本（实时调试）

```bash
# 运行开发服务
npm run dev:mp-weixin

# 微信开发者工具会自动刷新
# 代码修改后实时更新
```

### 生产版本（发布用）

```bash
# 构建生产版本
npm run build:mp-weixin

# 使用 dist/build/mp-weixin 目录上传
```

## 🐛 常见问题

### 1. 上传后提示"包大小超过限制"

**解决方案**：
```bash
# 检查 node_modules 是否被打包
# 确保 .gitignore 包含 node_modules

# 优化图片资源
# 使用分包加载
```

### 2. 真机预览时功能异常

**解决方案**：
- 检查微信开发者工具的基础库版本
- 建议设置：最低基础库版本 2.10.0
- 在 manifest.json → mp-weixin 中添加：
```json
"libVersion": "2.10.0"
```

### 3. 图片上传失败

**解决方案**：
- 检查权限配置
- 在小程序管理后台设置"服务器域名"
- 本地图片使用 base64 或临时路径

### 4. localStorage 数据丢失

**原因**：
- 小程序更新时可能清理缓存
- 用户清理微信缓存

**解决方案**：
- 提示用户定期备份
- 未来可添加云存储功能

### 5. editor 组件不显示

**解决方案**：
- 检查基础库版本（需要 2.7.0+）
- 检查 editor 组件的配置
- 查看控制台错误信息

## 📊 版本管理建议

### 版本号规则

```
主版本号.次版本号.修订号

1.0.0 - 初始版本
1.0.1 - Bug修复
1.1.0 - 新功能
2.0.0 - 重大更新
```

### 更新流程

```
1. 修改代码
2. 更新 manifest.json 中的 versionName
3. 构建新版本
4. 上传到微信后台
5. 提交审核
6. 审核通过后发布
```

## 🔐 隐私协议

小程序需要在管理后台设置：

1. **用户隐私保护指引**
2. **小程序服务条款**

### 隐私保护指引模板

```
《云日记隐私保护指引》

我们非常重视用户隐私保护。

一、我们收集的信息
本小程序不会收集或上传您的任何个人信息。所有日记数据均存储在您的设备本地。

二、信息使用
您的日记内容、图片、视频等信息均存储在微信提供的本地存储空间，不会上传到任何服务器。

三、相机和相册权限
我们需要您授权相机和相册权限，用于：
- 拍照添加到日记
- 从相册选择图片添加到日记
这些图片仅存储在本地，不会上传。

四、数据安全
本小程序不会收集、传输或存储您的任何个人信息到远程服务器。

五、联系我们
如有问题，请通过小程序内的反馈功能联系我们。
```

## 📈 数据统计

微信小程序自带数据统计：

1. 访问量（PV/UV）
2. 用户留存率
3. 使用时长
4. 功能使用情况

可在管理后台查看：统计 → 数据分析

## 🎯 推广建议

### 小程序码

1. 在管理后台生成小程序码
2. 分享到朋友圈、社群
3. 印刷到宣传物料上

### 搜索优化

1. 完善小程序信息
2. 添加准确的关键词
3. 引导用户评价和分享

### 社交分享

在代码中添加分享功能：
```javascript
onShareAppMessage() {
  return {
    title: '云日记 - 记录生活的美好',
    path: '/pages/index/index',
    imageUrl: '/static/share.png'
  }
}
```

## 📞 技术支持

- 微信开放文档：https://developers.weixin.qq.com/miniprogram/dev/framework/
- uni-app 文档：https://uniapp.dcloud.net.cn/
- 问题反馈：小程序管理后台

---

## ✅ 快速检查清单

发布前检查：

- [ ] manifest.json 配置正确
- [ ] AppID 正确填写
- [ ] 代码构建成功
- [ ] 微信开发者工具预览正常
- [ ] 真机测试通过
- [ ] 所有功能测试完成
- [ ] 准备好小程序截图
- [ ] 准备好隐私协议
- [ ] 版本号和描述填写完整

## 🚀 开始发布

现在运行：
```bash
npm run build:mp-weixin
```

然后在微信开发者工具中导入 `dist/build/mp-weixin` 目录，即可开始发布流程！

祝发布顺利！🎉

